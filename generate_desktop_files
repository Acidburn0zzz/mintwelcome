#!/usr/bin/python

import os, gettext

DOMAIN = "mintwelcome"
PATH = "/usr/share/linuxmint/locale"

def generate(filename, prefix, name, comment, suffix, genericName=None):
    desktopFile = open(filename, "w")
    desktopFile.writelines(prefix)

    desktopFile.writelines("Name=%s\n" % name)
    for directory in sorted(os.listdir(PATH)):
        if os.path.isdir(os.path.join(PATH, directory)):
            try:
                language = gettext.translation(DOMAIN, PATH, languages=[directory])
                language.install()          
                desktopFile.writelines("Name[%s]=%s\n" % (directory, _(name)))
            except:
                pass

    if (genericName is not None):
        desktopFile.writelines("GenericName=%s\n" % genericName)
        for directory in sorted(os.listdir(PATH)):
            if os.path.isdir(os.path.join(PATH, directory)):
                try:
                    language = gettext.translation(DOMAIN, PATH, languages=[directory])
                    language.install()          
                    desktopFile.writelines("GenericName[%s]=%s\n" % (directory, _(genericName)))
                except:
                    pass

    desktopFile.writelines("Comment=%s\n" % comment)
    for directory in sorted(os.listdir(PATH)):
        if os.path.isdir(os.path.join(PATH, directory)):
            try:
                language = gettext.translation(DOMAIN, PATH, languages=[directory])
                language.install()                      
                desktopFile.writelines("Comment[%s]=%s\n" % (directory, _(comment)))
            except:
                pass

    desktopFile.writelines(suffix)

prefix = """[Desktop Entry]
Exec=mintwelcome
Icon=/usr/lib/linuxmint/mintWelcome/icons/logo.svg
Terminal=false
Type=Application
Encoding=UTF-8
Categories=GNOME;GTK;Settings;DesktopSettings;
NotShowIn=KDE;
StartupNotify=false
"""

os.environ['LANG'] = "en"
gettext.install(DOMAIN, PATH)
generate("usr/share/applications/mintWelcome.desktop", prefix, _("Welcome Screen"), _("Introduction to Linux Mint"), "")

prefix = """[Desktop Entry]
Exec=mintwelcome
Icon=/usr/lib/linuxmint/mintWelcome/icons/logo_kde.svg
Terminal=false
Type=Application
Encoding=UTF-8
OnlyShowIn=KDE;
Categories=System;
StartupNotify=false
"""
os.environ['LANG'] = "en"
gettext.install(DOMAIN, PATH)
generate("usr/share/applications/kde4/mintWelcome.desktop", prefix, _("Welcome Screen"), _("Introduction to Linux Mint"), "", _("Welcome Screen"))

prefix = """[Desktop Entry]
Exec=apturl apt://mint-meta-codecs?refresh=yes
Icon=applications-multimedia
Terminal=false
Type=Application
Encoding=UTF-8
Categories=Application;AudioVideo;Audio;
StartupNotify=false
"""

os.environ['LANG'] = "en"
gettext.install(DOMAIN, PATH)
generate("mint-meta-codecs.desktop", prefix, _("Install Multimedia Codecs"), _("Add all the missing multimedia codecs"), "")

